"use strict";(self["webpackChunkmetawall"]=self["webpackChunkmetawall"]||[]).push([[754],{4799:function(e,t,r){var a=r(3766);t["Z"]=(0,a.Q_)("statusStore",{state:()=>({isLoading:!1,hideSidebar:!1})})},2416:function(e,t,r){r.d(t,{C:function(){return n},s:function(){return s}});var a=r(2492),o=r.n(a);const n=(e,t=1e3,r=!1)=>o().fire({icon:"success",text:e,timer:t,showConfirmButton:r}),s=(e="這是無效的操作！")=>{o().fire({icon:"error",text:e})}},3754:function(e,t,r){r.r(t),r.d(t,{default:function(){return F}});var a=r(3396),o=r(9242),n=r(7139);const s=(0,a._)("div",{class:"overlapping border border-2 border-dark text-center font-monospace bg-white py-5 mb-4"},[(0,a._)("h2",{class:"fs-5"},"張貼動態")],-1),d={class:"card shadow-card-2 border border-2 border-dark"},l={class:"card-body p-8"},i={class:"mb-4"},c=(0,a._)("label",{for:"content",class:"form-label"},"貼文內容",-1),b=(0,a.Uk)("上傳圖片 "),u={key:0,class:"ratio ratio-16x9 | mb-4"},p=["src"],m={key:1,class:"text-center text-danger | mb-4"},g=(0,a.Uk)(" 圖片檔案過大，僅限 1mb 以下檔案"),f=(0,a._)("br",null,null,-1),h=(0,a.Uk)(" 圖片格式錯誤，僅限 JPG、PNG 圖片 "),v=[g,f,h],w={class:"text-center"},k={key:0,type:"submit",class:"w-60 | btn btn-gray-2 | border border-2 border-dark | lh-sm | py-4",disabled:""},y={key:1,type:"submit",class:"w-60 | btn btn-shadow btn-warning | border border-2 border-dark | lh-sm | py-4"};function _(e,t,r,g,f,h){return(0,a.wg)(),(0,a.iD)(a.HY,null,[s,(0,a._)("div",d,[(0,a._)("div",l,[(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,o.iM)(((...e)=>g.sendPost&&g.sendPost(...e)),["prevent"]))},[(0,a._)("div",i,[c,(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.post.content=e),class:"form-control rounded-0 border-2 border-dark px-4 py-3",id:"content",rows:"7",placeholder:"輸入您的貼文內容"},null,512),[[o.nr,g.post.content]])]),(0,a._)("label",{class:(0,n.C_)(["btn btn-dark | rounded-2 | py-1 px-8",{"mb-4":g.isUploaded,"mb-8":!g.isUploaded}]),for:"image"},[b,(0,a._)("input",{onChange:t[1]||(t[1]=(...e)=>g.uploadImage&&g.uploadImage(...e)),class:"d-none",type:"file",name:"image",id:"image"},null,32)],2),g.post.imageUrl?((0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("img",{src:g.post.imageUrl,alt:"photo",class:"image-control | border rounded-8 border-2 border-dark"},null,8,p)])):(0,a.kq)("",!0),g.isFailed?((0,a.wg)(),(0,a.iD)("div",m,v)):(0,a.kq)("",!0),(0,a._)("div",w,[g.post.content?((0,a.wg)(),(0,a.iD)("button",y," 送出貼文 ")):((0,a.wg)(),(0,a.iD)("button",k," 送出貼文 "))])],32)])])],64)}var U=r(4870),x=r(678),C=r(4799),D=r(8042),P=r(2416),S={setup(){const e=(0,x.tv)(),t=(0,C.Z)(),r=(0,U.iH)({content:"",imageUrl:""}),o=async()=>{try{await(0,D.Z)("/posts","post",r.value),(0,P.C)("成功發送貼文！").then((()=>e.push("/posts")))}catch(t){console.log(t)}},n=(0,U.iH)(!1),s=(0,U.iH)(!1),d=async e=>{const t=new FormData;t.append("image",e.target.files[0]);try{const e=await(0,D.Z)("/upload","post",t);n.value=!0,r.value.imageUrl=e.data.imageUrl,(0,P.C)("上傳成功！")}catch(a){console.log(a),(0,P.s)("上傳失敗，請重新上傳圖片！"),s.value=!0,setTimeout((()=>{s.value=!1}),5e3)}};return(0,a.bv)((()=>{t.hideSidebar=!0})),(0,a.Ah)((()=>{t.hideSidebar=!1})),{post:r,sendPost:o,uploadImage:d,isFailed:s,isUploaded:n}}},Z=r(89);const H=(0,Z.Z)(S,[["render",_]]);var F=H}}]);
//# sourceMappingURL=754.f47ab43f.js.map